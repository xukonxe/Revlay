# Revlay 项目实施计划书

**项目名称**: Revlay
**创始人**: xukonxe
**日期**: 2025年7月8日
**核心定位**: 一个现代、快速、无依赖的部署与服务器生命周期管理工具，旨在为非容器化应用提供极致优雅的发布与维护体验。

---

## 1. 商业分析 (Business Analysis)

### 1.1. 问题陈述 (The Problem)

在云原生和容器化大行其道的今天，仍有数百万计的应用（PHP、Python、Go、静态网站等）以非容器化的形式运行在虚拟机或物理服务器上。这些应用的开发者和运维人员在部署和管理上长期面临以下痛点：

-   **工具链依赖地狱**: 传统自动化部署工具（如Capistrano）要求在本地和服务器端安装特定语言的运行时（如Ruby），这对于异构技术栈的团队（如Go/PHP团队）是沉重的技术债务和管理负担。
-   **流程复杂且易错**: 手动部署（如FTP/SCP）流程繁琐、缺乏原子性，极易因网络中断或人为失误导致线上服务中断或处于不一致的"中间状态"。
-   **配置管理工具过重**: 使用Ansible等重量级工具来实现简单的原子化部署，需要学习复杂的DSL（如YAML Playbook），对于仅需部署功能的用户来说属于"牛刀杀鸡"，学习和维护成本高昂。
-   **缺乏统一的管理视图**: 开发者需要在部署工具、SSH终端、文件管理器等多个分离的工具间来回切换，工作流割裂，效率低下。

### 1.2. 解决方案 (The Solution: Revlay)

Revlay 旨在通过提供一个统一、现代、高效的解决方案，彻底解决以上痛点。

-   **核心产品 (Revlay CLI - Free & Open Source)**: 一个基于Go语言编写的命令行工具。
    -   **无依赖**: 单一二进制文件，在任何主流操作系统上无需安装任何运行时即可工作。
    -   **原子化部署**: 内置经典的"符号链接"部署策略，确保版本切换在一瞬间完成，实现零停机部署。
    -   **结构化管理**: 强制实施 `releases` / `shared` / `current` 目录结构，自动处理版本管理、一键回滚和跨版本文件共享。
    -   **配置简单**: 通过一个清晰、易于理解的 `revlay.yml` 文件管理所有部署配置。

-   **扩展产品 (Revlay Desktop & Mobile - Pro Version)**: 一个跨平台的图形用户界面客户端。
    -   **远程管理中心**: 提供一个统一的界面来管理所有服务器，实时查看服务器状态（CPU、内存、磁盘等）。
    -   **可视化操作**: 通过点击按钮即可完成部署、回滚、日志查看、文件管理等所有操作。
    -   **安全的Client-Agent架构**: 基于SSH信道，在被管服务器上运行一个轻量级的`revlay-agent`，确保操作的原子性、高效性和安全性。

### 1.3. 盈利模式 (Monetization Strategy)

Revlay 将采用成熟的 **开源核心 + 增值服务 (Open Core)** 盈利模式。

-   **免费版 (Free Tier)**:
    -   `Revlay CLI` 将完全免费并开源。这是项目的核心引擎，用于吸引开发者、建立社区信任和驱动口碑传播。

-   **专业版 (Pro Tier - 订阅制)**:
    -   `Revlay Desktop & Mobile App`: 提供功能强大的UI客户端，作为核心付费点。
    -   **团队协作功能**: 为团队提供用户权限管理、操作审计日志、部署审批流等高级功能。
    -   **云同步服务**: 在用户的多个设备间安全地同步服务器列表和配置。

---

## 2. 商业调查 (Market & Competitive Analysis)

### 2.1. 目标用户画像

-   **Go语言开发者**: 天然的种子用户，会优先选择同技术栈的工具。
-   **前端及静态网站开发者**: 需要简单、快速的部署方案，厌倦复杂的后端工具链。
-   **PHP/Python/Ruby开发者**: 对现有工具的运行时依赖和性能感到不满，寻求现代化的替代品。
-   **中小型企业及独立开发者**: 需要一个高性价比、低维护成本的服务器管理和部署解决方案。

### 2.2. 市场机会

-   **巨大的存量市场**: 非容器化应用的市场规模依然庞大，且被现有工具服务得不够好。
-   **对"简便"的追求**: 开发者越来越倾向于选择"开箱即用"、学习曲线平缓的工具。
-   **Go语言生态红利**: Go在DevOps工具领域的成功（如Docker, Terraform）证明了其技术优势深受开发者信赖。

### 2.3. 竞争格局分析

| 竞争对手 | 优势 | 劣势 (Revlay的机会) |
| :--- | :--- | :--- |
| **Capistrano (Ruby)** | 功能成熟，生态丰富 | 运行时依赖；性能较差；对非Ruby社区不友好 |
| **Deployer (PHP)** | 在PHP社区流行 | 运行时依赖；社区局限于PHP |
| **Ansible** | 功能极其强大 | 过于复杂；学习曲线陡峭；为部署而写Playbook太重 |
| **RunCloud等平台** | UI友好，一站式 | 通常与特定技术栈绑定；不够灵活；是黑盒系统 |

**Revlay 的差异化优势**: Revlay 精准地占据了一个独特的生态位——它拥有专用部署工具的简单性，配置管理工具的灵活性（通过Agent），以及商业平台的现代化体验（通过UI），同时通过Go语言彻底消除了运行时依赖这一最大痛点。

---

## 3. 技术实现 (Technical Implementation)

### 3.1. 技术栈

-   **后端/CLI/Agent**: Go
-   **桌面客户端**: Go + Fyne / Wails, 或使用Tauri (Rust + Web) / Electron (Node.js + Web)
-   **移动客户端**: Flutter / React Native, 或原生开发 (Swift/Kotlin)
-   **配置文件**: YAML
-   **通信协议**: SSH

### 3.2. 开发路线图 (Roadmap)

**阶段一: MVP - 打造完美的CLI (预计3-4个月)**
-   **目标**: 发布 `Revlay CLI v1.0`，成为一个功能完整、体验惊艳的部署工具。
-   **核心功能**:
    -   `revlay init`: 初始化 `revlay.yml` 配置文件。
    -   `revlay deploy`: 实现完整的原子化部署流程（连接服务器 -> 上传版本 -> 解压 -> 执行钩子 -> 切换符号链接 -> 清理旧版本）。
    -   `revlay rollback`: 实现一键回滚到上一版本。
    -   `revlay releases`: 列出所有历史版本。
    -   **文件共享策略**: 同时支持"环境变量注入"和"符号链接"两种模式，可在`revlay.yml`中配置。
    -   **部署钩子**: 支持在部署流程的各个阶段（如post-unpack, pre-switch）执行自定义脚本。
    -   **完善的文档**: 撰写清晰的安装、配置和使用文档。

**阶段二: Alpha - 桌面客户端与Agent (预计4-6个月)**
-   **目标**: 发布 `Revlay Desktop Alpha`，验证Client-Agent架构。
-   **核心功能**:
    -   `revlay-agent`: 开发服务器端代理。提供稳定的API（通过SSH信道调用），用于获取系统指标（CPU, Mem等）和执行原子操作（如部署）。
    -   **桌面客户端**:
        -   实现安全的SSH连接管理（可加密存储私钥）。
        -   开发一个实时的服务器状态仪表盘。
        -   将CLI的部署/回滚功能，在UI上通过按钮实现。

**阶段三: Beta - 完善UI与推出Pro版 (持续迭代)**
-   **目标**: 公开测试桌面客户端，并上线付费订阅系统。
-   **核心功能**:
    -   在UI中增加文件管理器、日志查看器等功能。
    -   构建官网、支付和用户授权系统。
    -   开始Pro版的Alpha测试。

**阶段四: 进军移动端 (长期愿景)**
-   **目标**: 将核心的"查看"和"轻量操作"功能延伸到移动设备。

### 3.4. 技术细节 (Technical Details)

-   **目录结构**:
    ```
    /opt/myapp/
    ├── releases/
    │   ├── v1.0.0/
    │   └── v1.1.0/
    ├── shared/
    │   └── config.json
    └── current -> /opt/myapp/releases/v1.1.0 (符号链接)
    ```
-   **SSH连接**: 使用Go原生的 `crypto/ssh` 包，实现对密码、私钥、SSH Agent等多种认证方式的支持。
-   **原子性保证**: 切换版本的核心操作 `ln -sfn new_release current` 是Linux文件系统层面的原子操作，这是零停机部署的关键。Agent提供的所有操作接口，也必须设计为原子性的。
-   **安全性**:
    -   所有通信都强制通过SSH信道，享受其固有的加密和认证能力。
    -   桌面客户端存储的私钥或密码，必须使用操作系统提供的钥匙串服务（Keychain/Keyring）进行加密存储。
    -   Agent绝不开放任何额外的网络端口。 